{"ast":null,"code":"import _classCallCheck from\"D:/collection/PROJECT`s/JAPAN/8863074498439810063enhancementv7/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"D:/collection/PROJECT`s/JAPAN/8863074498439810063enhancementv7/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import*as BABYLON from\"babylonjs\";import\"babylonjs-loaders\";import{Categories}from\"../../Config.json\";var LoaderManager=/*#__PURE__*/function(){function LoaderManager(sceneManager){_classCallCheck(this,LoaderManager);this.game=sceneManager.game;this.scene=sceneManager.scene;this.sceneManager=sceneManager;}_createClass(LoaderManager,[{key:\"loadItemById\",value:function loadItemById(type,name){var _this=this;var onLoad=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;//Load Sock Model\nconsole.log(\"type\",type,\"-__-\",name);var loadingOpts={path:\"./models/\".concat(type,\"/\"),name:\"\".concat(name,\".gltf\")};var assetsManager=new BABYLON.AssetsManager(this.scene);var itemTask=assetsManager.addMeshTask(\"itemTask\",\"\",loadingOpts.path,loadingOpts.name);itemTask.onSuccess=function(task){var itemMesh=task.loadedMeshes.find(function(mesh){return mesh.name===\"__root__\";});_this.sceneManager.charcterProps[type]=itemMesh;_this.sceneManager.charcterProps[type].myId=name;if(name!==\"base\"){_this.sceneManager.charcterProps[type].price=Categories[type][name].price;_this.sceneManager.charcterProps[type].itemName=Categories[type][name].name;}for(var j=0;j<task.loadedMeshes.length;j++){var mesh=task.loadedMeshes[j];if(mesh.getTotalVertices()>0){//if it's mesh\n_this.sceneManager.mirror.renderList.push(mesh);// this.sceneManager.shadowGenerator\n//   .getShadowMap()\n//   .renderList.push(mesh);\n// this.sceneManager.shadowGenerator.addShadowCaster(mesh, true);\n}}if(type===\"pet\"){var opt=Categories[type][name].opt;itemMesh.position=new BABYLON.Vector3(opt.x,opt.y,0);itemMesh.scaling=new BABYLON.Vector3(opt.scale,opt.scale,opt.scale);}else{itemMesh.scaling=new BABYLON.Vector3(5,5,5);}if(name===\"baloon\")itemMesh.position.x=-7;onLoad({data:_this.sceneManager.getCharcterSummary(),totalPrice:_this.sceneManager.getTotatlPrice()});};assetsManager.onProgress=function(remainingCount,totalCount,lastFinishedTask){_this.game.engine.loadingUIText=\"loading Assets \"+remainingCount+\" out of \"+totalCount+\" items still need to be loaded.\";};assetsManager.onFinish=function(tasks){// console.log(\"disable Loading bar\");\n};// Start loading\nassetsManager.useDefaultLoadingScreen=false;assetsManager.load();}}]);return LoaderManager;}();export{LoaderManager as default};","map":{"version":3,"sources":["D:/collection/PROJECT`s/JAPAN/8863074498439810063enhancementv7/src/Babylon/StudioScene/LoaderManager.js"],"names":["BABYLON","Categories","LoaderManager","sceneManager","game","scene","type","name","onLoad","console","log","loadingOpts","path","assetsManager","AssetsManager","itemTask","addMeshTask","onSuccess","task","itemMesh","loadedMeshes","find","mesh","charcterProps","myId","price","itemName","j","length","getTotalVertices","mirror","renderList","push","opt","position","Vector3","x","y","scaling","scale","data","getCharcterSummary","totalPrice","getTotatlPrice","onProgress","remainingCount","totalCount","lastFinishedTask","engine","loadingUIText","onFinish","tasks","useDefaultLoadingScreen","load"],"mappings":"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","sourcesContent":["import * as BABYLON from \"babylonjs\";\r\nimport \"babylonjs-loaders\";\r\nimport { Categories } from \"../../Config.json\";\r\n\r\nexport default class LoaderManager {\r\n  constructor(sceneManager) {\r\n    this.game = sceneManager.game;\r\n    this.scene = sceneManager.scene;\r\n    this.sceneManager = sceneManager;\r\n  }\r\n  loadItemById(type, name, onLoad = null) {\r\n    //Load Sock Model\r\n    console.log(\"type\", type, \"-__-\", name);\r\n    let loadingOpts = {\r\n      path: `./models/${type}/`,\r\n      name: `${name}.gltf`,\r\n    };\r\n\r\n    let assetsManager = new BABYLON.AssetsManager(this.scene);\r\n    let itemTask = assetsManager.addMeshTask(\r\n      \"itemTask\",\r\n      \"\",\r\n      loadingOpts.path,\r\n      loadingOpts.name\r\n    );\r\n    itemTask.onSuccess = (task) => {\r\n      let itemMesh = task.loadedMeshes.find((mesh) => mesh.name === \"__root__\");\r\n      this.sceneManager.charcterProps[type] = itemMesh;\r\n      this.sceneManager.charcterProps[type].myId = name;\r\n      if (name !== \"base\") {\r\n        this.sceneManager.charcterProps[type].price =\r\n          Categories[type][name].price;\r\n\r\n        this.sceneManager.charcterProps[type].itemName =\r\n          Categories[type][name].name;\r\n      }\r\n\r\n      for (let j = 0; j < task.loadedMeshes.length; j++) {\r\n        let mesh = task.loadedMeshes[j];\r\n        if (mesh.getTotalVertices() > 0) {\r\n          //if it's mesh\r\n          this.sceneManager.mirror.renderList.push(mesh);\r\n          // this.sceneManager.shadowGenerator\r\n          //   .getShadowMap()\r\n          //   .renderList.push(mesh);\r\n          // this.sceneManager.shadowGenerator.addShadowCaster(mesh, true);\r\n        }\r\n      }\r\n      if (type === \"pet\") {\r\n        const { opt } = Categories[type][name];\r\n\r\n        itemMesh.position = new BABYLON.Vector3(opt.x, opt.y, 0);\r\n        itemMesh.scaling = new BABYLON.Vector3(opt.scale, opt.scale, opt.scale);\r\n      } else {\r\n        itemMesh.scaling = new BABYLON.Vector3(5, 5, 5);\r\n      }\r\n      if (name === \"baloon\") itemMesh.position.x = -7;\r\n\r\n      onLoad({\r\n        data: this.sceneManager.getCharcterSummary(),\r\n        totalPrice: this.sceneManager.getTotatlPrice(),\r\n      });\r\n    };\r\n\r\n    assetsManager.onProgress = (\r\n      remainingCount,\r\n      totalCount,\r\n      lastFinishedTask\r\n    ) => {\r\n      this.game.engine.loadingUIText =\r\n        \"loading Assets \" +\r\n        remainingCount +\r\n        \" out of \" +\r\n        totalCount +\r\n        \" items still need to be loaded.\";\r\n    };\r\n\r\n    assetsManager.onFinish = (tasks) => {\r\n      // console.log(\"disable Loading bar\");\r\n    };\r\n    // Start loading\r\n    assetsManager.useDefaultLoadingScreen = false;\r\n    assetsManager.load();\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}